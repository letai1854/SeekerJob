

@using SeekerJob.DataSystem
@using SeekerJob.DTO

@{
    var table = ViewData["savejob"] as List<SaveJobViewModal>;


}



<div class="col-xl-9 col-lg-8 col-md-12 m-b30">
    <!--Filter Short By-->
    <div class="twm-right-section-panel candidate-save-job site-bg-gray">
        <div class="twm-D_table table-responsive">
            <table id="jobs_bookmark_table" class="table table-bordered twm-candidate-save-job-list-wrap">
                <thead>
                    <tr>
                        <th>Tiêu đề công việc</th>
                        <th>Công ty</th>    
                        <th>Ngày</th>
                        <th>Hành động</th>

                    </tr>
                </thead>
                <tbody>
                    <!--1-->

                    @foreach (var item in table)
                    {
                        <tr id="trs_@item.saveJob.idjob">
                            <td>
                                <div class="twm-candidate-save-job-list">
                                    <div class="twm-media">
                                        <div class="twm-media-pic">
                                            <img src="~/ContentImage/images/@item.InforEmployer.image" alt="#">
                                        </div>
                                    </div>
                                    <div class="twm-mid-content">
                                        <h4>@item.Job.title</h4>
                                    </div>

                                </div>
                            </td>
                            <td><a href="@ViewBag.congty/@item.InforEmployer.namecompany">@item.InforEmployer.namecompany</a></td>
                            <td>
                                <div>
                                    @if (item.saveJob.saveDate != null)
                                    {
                                        <p>@item.saveJob.saveDate</p>

                                    }
                                    else
                                    {
                                        <p>20/11/2028</p>
                                    }

                            </div>
                        </td>

                        <td>
                            <div class="twm-table-controls">
                                <ul class="twm-DT-controls-icon list-unstyled">
                                    <li>
                                        <a href="@ViewBag.vieclam/@item.Job.meta/@item.Job.id" class="custom-toltip">
                                            <span class="fa fa-eye"></span>
                                            <span class="custom-toltip-block">Veiw</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:Delete('@item.saveJob.idjob', '@item.Job.title')" title="Delete" data-bs-toggle="tooltip" data-bs-placement="top">
                                            <span class="far fa-trash-alt"></span>
                                        </a>
                                        @*<button title="Delete" data-bs-toggle="tooltip" data-bs-placement="top">
                                                <span class="far fa-trash-alt"></span>
                                            </button>*@
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                }




                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function Delete(id, title) {
        if (confirm('Bạn có chắc muốn xóa không: ' + title)) {
            var form = new FormData();
            form.append('id', id);
            var xhr = new XMLHttpRequest();
            xhr.open("POST", '/SavedJobCandidates/DeleteSavedJob', true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var content = xhr.responseText;
                    var json_ct = JSON.parse(content);
                    if (json_ct.Data.status == "OK") {
                        // Xóa hàng khỏi DOM
                        
                        $('#trs_' + id).fadeOut(300, function () {
                            $(this).remove();
                        });

                        // Gọi AJAX để cập nhật lại danh sách sau khi xóa
                        //$.ajax({
                        //    url: '/SavedJobCandidates/GetListSavedJob',
                        //    type: 'GET',
                        //    data: { page: currentPage }, // Gửi số trang hiện tại
                        //    success: function (data) {
                        //        $('#jobs_bookmark_table tbody').html(data);
                        //    },
                        //    error: function () {
                        //        alert("Error reloading the job list.");
                        //    }
                        //});
                    } else {
                        alert("Error");
                    }
                }
            };
            xhr.send(form);
        }
    }

</script>

